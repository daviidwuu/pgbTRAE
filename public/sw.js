(()=>{let e=[{'revision':'fe0d63d8a322224bb648ffce54bbd0ae','url':'/_next/app-build-manifest.json'},{'revision':'821427b9f0822c1cd9bbff81fe9fa7e9','url':'/_next/react-loadable-manifest.json'},{'revision':'e31e5bfde30270385dd5cc16c7b41a72','url':'/_next/server/app/_not-found/page_client-reference-manifest.js'},{'revision':'80ee28a8e39c26e71b7b638eef916ace','url':'/_next/server/app/api/push-subscriptions/route_client-reference-manifest.js'},{'revision':'a6ea9b34f68a861ffeb57433887a77e3','url':'/_next/server/app/login/page_client-reference-manifest.js'},{'revision':'9658e654306b12e9abf2b2cfc5b6adc8','url':'/_next/server/app/page_client-reference-manifest.js'},{'revision':'59f9a4f1b1f560550a6a5f1a916fdcb8','url':'/_next/server/middleware-build-manifest.js'},{'revision':'d38f973594fc40ddb8020f5cd7723c89','url':'/_next/server/middleware-react-loadable-manifest.js'},{'revision':'02ca660aea97f81d8955b16919d666b1','url':'/_next/server/next-font-manifest.js'},{'revision':'67e65b114f35c2d0022869568ee5f8f8','url':'/_next/server/next-font-manifest.json'},{'revision':'ae6c8c863064d8ba','url':'/_next/static/chunks/145.ae6c8c863064d8ba.js'},{'revision':'40c0f50b56af7182','url':'/_next/static/chunks/198.40c0f50b56af7182.js'},{'revision':'ee07eb8aa4bbf803','url':'/_next/static/chunks/2.ee07eb8aa4bbf803.js'},{'revision':'58bea61486d467b2','url':'/_next/static/chunks/226.58bea61486d467b2.js'},{'revision':'714e9be64b3435e3','url':'/_next/static/chunks/229.714e9be64b3435e3.js'},{'revision':'103baf4acbd11ff9','url':'/_next/static/chunks/258.103baf4acbd11ff9.js'},{'revision':'b85ca9176a2ec435','url':'/_next/static/chunks/434.b85ca9176a2ec435.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/470-80d1d51f38707447.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/4bd1b696-0c62b2bae3c1ba8f.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/663-456b227af2d6489b.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/684-d98ca38c84297ddb.js'},{'revision':'f6c7028d94256d19','url':'/_next/static/chunks/699.f6c7028d94256d19.js'},{'revision':'ce5e9d2a78a8a51b','url':'/_next/static/chunks/700.ce5e9d2a78a8a51b.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/713-0b2ea3fe8839ea38.js'},{'revision':'28653b45a1e32244','url':'/_next/static/chunks/754.28653b45a1e32244.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/755-48274123fcc0864b.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/7c86ec74-188e20a1cf53b70c.js'},{'revision':'375602b07a839fce','url':'/_next/static/chunks/879.375602b07a839fce.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/app/_not-found/page-a3cc41667356e2de.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/app/api/push-subscriptions/route-fb35926473ea693f.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/app/layout-1c6a8f575fc490b7.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/app/login/page-427c5a5b93a887d0.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/app/page-3630eb331e773602.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/bc9e92e6-f406a64c282dd5b0.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/framework-6d868e9bc95e10d8.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/main-app-e636998258664939.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/main-b0b2cee67b37caac.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/pages/_app-da15c11dea942c36.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/pages/_error-cc3f077a18ea1793.js'},{'revision':'846118c33b2c0e922d7b3a7676f81f6f','url':'/_next/static/chunks/polyfills-42372ed130431b0a.js'},{'revision':'_pwRHh5kUYArgBwWlVInT','url':'/_next/static/chunks/webpack-1cc4b2c20be898a6.js'},{'revision':'2afa6736fb49e451','url':'/_next/static/css/2afa6736fb49e451.css'},{'revision':'be8ee93a8cf390eb9cb6e6aadf1a3bf0','url':'/_next/static/media/24c15609eaa28576-s.woff2'},{'revision':'399fb80a20ea7d2a53a1d6dc1e5f392a','url':'/_next/static/media/2c07349e02a7b712-s.woff2'},{'revision':'4746809ed1c17447d45d2a96c64796d4','url':'/_next/static/media/47cbc4e2adbc5db9-s.p.woff2'},{'revision':'c46f88e9518178fd56311db461452f8d','url':'/_next/static/media/627d916fd739a539-s.woff2'},{'revision':'99ebacc4dfd7bd21bf48d21306c0dd42','url':'/_next/static/media/74c003a2abab0c4f-s.woff2'},{'revision':'bdf2a9a2d904dc21d9b593b82887af52','url':'/_next/static/media/84602850c8fd81c3-s.woff2'},{'revision':'5489c188e786a745bd9ba1bc9fbf7f71','url':'/_next/static/media/90da053edc2b7de3-s.woff2'},{'revision':'9df032a6b99e0fce98ec4ad311b0fd7d','url':'/_next/static/media/ac3b7908202f8517-s.woff2'},{'revision':'6f64aa964b323b9c0e5dbce214081225','url':'/_next/static/media/b5ee789b512e4d1b-s.woff2'},{'revision':'bd711f7e9ef9b234cd10570055c44e91','url':'/icon.png'},{'revision':'94a208567b27ee2ee4fee63e53311710','url':'/manifest.json'},{'revision':'cdec93f25f4fe61293bb9b9fe56bdab0','url':'/sw-source.js'}]||[];self.addEventListener("install",t=>{console.log("[SW] Installing service worker with precache manifest"),t.waitUntil(caches.open("precache-v1").then(t=>t.addAll(e.map(e=>e.url)))),self.skipWaiting()}),self.addEventListener("activate",e=>{console.log("[SW] Activating service worker"),e.waitUntil(self.clients.claim())}),self.addEventListener("fetch",e=>{let{request:t}=e,a=new URL(t.url);return"fonts.googleapis.com"===a.hostname||"fonts.gstatic.com"===a.hostname?void e.respondWith(caches.open("google-fonts-cache").then(e=>e.match(t).then(a=>a||fetch(t).then(a=>(e.put(t,a.clone()),a))))):"image"===t.destination?void e.respondWith(caches.open("images-cache").then(e=>e.match(t).then(a=>{let i=fetch(t).then(a=>(e.put(t,a.clone()),a));return a||i}))):a.pathname.startsWith("/api/")?void e.respondWith(fetch(t).then(e=>{if(e.ok){let a=e.clone();caches.open("api-cache").then(e=>{e.put(t,a)})}return e}).catch(()=>caches.match(t))):"firestore.googleapis.com"===a.hostname?void e.respondWith(fetch(t)):void e.respondWith(caches.match(t).then(e=>e||fetch(t)))}),(()=>{let e="push-subscription-metadata",t=new Request("/__push_subscription_metadata__");function a(){if("undefined"==typeof navigator)return!1;let e=navigator.userAgent||"";return/iPad|iPhone|iPod/.test(e)&&/Safari/.test(e)&&!/CriOS|FxiOS/.test(e)}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("[SW Push - iOS] ".concat(e),t),t&&t.error&&console.error("[SW Push Error - iOS]",t.error)}async function n(n){if(!n||"object"!=typeof n)return void i("Invalid metadata payload",{payload:n});let{userId:o,vapidPublicKey:s}=n;if("string"!=typeof o||"string"!=typeof s)return void i("Invalid metadata format",{userId:typeof o,vapidPublicKey:typeof s});try{let n=await caches.open(e),r={userId:o,vapidPublicKey:s,isIOSSafari:a(),timestamp:Date.now()};await n.put(t,new Response(JSON.stringify(r),{headers:{"Content-Type":"application/json"}})),i("Metadata stored successfully",r)}catch(e){i("Failed to store metadata",{error:e})}}async function o(){try{let a=await caches.open(e),n=await a.match(t);if(!n)return i("No metadata found in cache"),null;let o=await n.json();return i("Metadata read successfully",o),o}catch(e){return i("Failed to read metadata",{error:e}),null}}async function s(e,t,n){if(!e||"string"!=typeof e.userId)throw Error("Missing user metadata for push subscription persistence.");let o=t.toJSON(),s={userId:e.userId,subscription:o,isIOSSafari:a(),userAgent:navigator.userAgent,timestamp:Date.now()};n&&(s.oldEndpoint=n),i("Persisting subscription to server",{userId:e.userId,isIOSSafari:s.isIOSSafari});try{let e=await fetch("/api/push-subscriptions",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-iOS-Safari":a()?"true":"false"},body:JSON.stringify(s)});if(!e.ok)throw Error("Failed to persist subscription: ".concat(e.status," - ").concat(e.statusText));i("Subscription persisted successfully")}catch(e){throw i("Failed to persist subscription",{error:e}),e}}async function r(e){try{let t=await self.clients.matchAll({type:"window",includeUncontrolled:!0}),n={type:"PUSH_SUBSCRIPTION_CHANGE",payload:{...e,isIOSSafari:a(),timestamp:Date.now()}};for(let e of(i("Broadcasting to ".concat(t.length," clients"),n),t))e.postMessage(n)}catch(e){i("Failed to broadcast subscription change",{error:e})}}self.addEventListener("push",e=>{let t;i("Push event received",{hasData:!!e.data});try{t=e.data?e.data.json():{},i("Push data parsed",t)}catch(e){i("Failed to parse push data",{error:e}),t={title:"PiggyBank",body:"You have a new financial update"}}let n={body:t.body||"Your financial activity has been updated",icon:"/icon.png",badge:"/icon.png",tag:"piggybank-notification",requireInteraction:!1,silent:!1,data:{url:t.url||"/",timestamp:Date.now(),isIOSSafari:a()}};a()&&(n.actions=[{action:"view",title:"View Details"}]);let o=t.title||"PiggyBank";i("Showing notification",{title:o,options:n}),e.waitUntil(self.registration.showNotification(o,n).then(()=>{i("Notification shown successfully")}).catch(e=>{i("Failed to show notification",{error:e})}))}),self.addEventListener("notificationclick",e=>{var t;i("Notification clicked",{action:e.action,data:e.notification.data}),e.notification.close();let n=(null==(t=e.notification.data)?void 0:t.url)||"/";e.waitUntil(self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(e=>{let t=e.find(e=>e.url.includes(self.location.origin));return t?(i("Focusing existing client"),t.focus().then(()=>{t.postMessage({type:"NOTIFICATION_CLICKED",url:n,isIOSSafari:a()})})):(i("Opening new client",{url:n}),self.clients.openWindow(n))}).catch(e=>{i("Failed to handle notification click",{error:e})}))}),self.addEventListener("pushsubscriptionchange",e=>{i("Push subscription changed"),e.waitUntil(o().then(t=>{if(!t)return void i("No metadata available for subscription change");let n=function(e){let t="=".repeat((4-e.length%4)%4),a=atob((e+t).replace(/-/g,"+").replace(/_/g,"/")),i=new Uint8Array(a.length);for(let e=0;e<a.length;++e)i[e]=a.charCodeAt(e);return i}(t.vapidPublicKey);return self.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n}).then(a=>{var n;return i("New subscription created",{endpoint:a.endpoint}),s(t,a,null==(n=e.oldSubscription)?void 0:n.endpoint)}).then(()=>r({type:"subscription_renewed",isIOSSafari:a()}))}).catch(e=>(i("Failed to handle subscription change",{error:e}),r({type:"subscription_error",error:e.message,isIOSSafari:a()}))))}),self.addEventListener("message",e=>{e.data&&"STORE_PUSH_METADATA"===e.data.type&&(i("Received metadata storage request",e.data.payload),e.waitUntil(n(e.data.payload)))}),self.addEventListener("error",e=>{i("Service Worker error",{error:e.error,filename:e.filename,lineno:e.lineno})}),self.addEventListener("unhandledrejection",e=>{i("Unhandled promise rejection",{reason:e.reason})})})()})();